RewriteEngine On

# Bazowa ścieżka, jeśli aplikacja jest w podkatalogu (dostosuj według potrzeb)
# RewriteBase /10devs/

# Przekierowanie /profile do profile.php
RewriteRule ^profile$ profile.php [L]

# Przekierowanie /dashboard do dashboard.php
RewriteRule ^dashboard$ dashboard.php [L]

# Przekierowanie /search do search.php
RewriteRule ^search$ search.php [L]

# Przekierowanie /login do login.php
RewriteRule ^login$ login.php [L]

# Przekierowanie /logout do logout.php
RewriteRule ^logout$ logout.php [L]

# Przekierowanie /register do register.php
RewriteRule ^register$ register.php [L]

# Przekierowanie /city/ID do city.php?id=ID
RewriteRule ^city/([0-9]+)$ city.php?id=$1 [L]

# Przekierowanie /admin/logs do admin/logs.php
RewriteRule ^admin/logs$ admin/logs.php [L]

# Przekierowanie /cities/search do cities/search.php
RewriteRule ^cities/search$ cities/search.php [L]

# API Endpoints

# 1b. Obsługa żądań PUT do konkretnego zasobu z ID: /api/cities/123
#     Przepisuje na update.php przekazując ID.
RewriteCond %{REQUEST_METHOD} PUT
RewriteRule ^api/cities/([0-9]+)$ api/cities/update.php?id=$1 [L]

# 1. Obsługa żądań do konkretnego zasobu z ID: /api/cities/123 (np. DELETE)
#    Przepisuje na index.php przekazując ID. Zachowuje query string ([QSA]).
RewriteRule ^api/cities/([0-9]+)$ api/cities/index.php?id=$1 [L,QSA]

# 2. Obsługa żądań do kolekcji: /api/cities (np. GET z filtrami)
#    Przepisuje na index.php. Zachowuje query string ([QSA]).
RewriteRule ^api/cities$ api/cities/index.php [L,QSA]

# STARA REGUŁA (zastąpiona przez powyższe): 
# RewriteRule ^api/cities(?:/([0-9]+))?$ api/cities/index.php?id=$1 [L,QSA]
# Usunięto również poleganie na DirectoryIndex dla POST

# Przekierowanie /api/users/register do api/users/register.php
RewriteRule ^api/users/register$ api/users/register.php [L]

# Obsługa zasobów statycznych (CSS, JS, obrazy)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} \.(css|js|jpg|jpeg|png|gif|ico)$
RewriteRule ^(.*)$ $1 [L]

# Przekierowanie wszystkich innych żądań do index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^ index.php [L]
